<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: list.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: list.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>let tasksInCurrentProject = [];
let assigments = [];
/* search the taskDummy object and gets the object with the user-id property that equals the id parameter*/
function getUserById(id) {
    for (let i = 0; i &lt; taskDummy["user-tasks"].length; i++) {
        const user = taskDummy["user-tasks"][i];
        if (user["user-id"] == id) {
            return user;
        }
    }
    return "NO_USER_WITH_ID: " + id + "FOUND";
}

/*returns an object that holds the information of an list-item element appended to list-content element from list.html*/
function createAssigment(user, task) {
    return {
        eisenhowerMatrixCategorie: getEisenhowerCategorie(task.importance, task["due-date"]),
        to: user,
        category: task["category"],
        details: task["description"]
    }
}

/*calculates the level of eisenhowermatrix categorie needed for the coloring of the list-item element*/
function getEisenhowerCategorie(important, dueDate) {
    let urgent = calculateUrgency(dueDate);
    if (urgent &amp;&amp; important) {
        return "do";
    }

    if (important &amp;&amp; !urgent) {
        return "schedule";
    }

    if (urgent &amp;&amp; !important) {
        return "delegate";
    }

    if (!urgent &amp;&amp; !important) {
        return "eliminate";
    }
}

/*calculates the urgency of a task
* if difference of given date and time is less then one day, then task is urgen
* else task is not urgent
*/
function calculateUrgency(date) {
    const oneDayMilliseconds = 86400000;
    let time = new Date().getTime();
    let dateToMilliseconds = new Date(date).getTime();
    let timeDifference = dateToMilliseconds - time;

    // true = urgent
    return timeDifference &lt; oneDayMilliseconds;

}

/*a task can be added to more projects*/
/*initialise tasksInCurrentProject only with the tasks of a given user that are added to a projectId*/
function initUserTasksFromProjectId(user, projectId) {
    user.tasks.forEach(task => {
        task["in-projects"].forEach(id => {
            if (id == projectId) {
                tasksInCurrentProject.push(task);
            }
        });
    });
}

/*a task can be assign to more users*/
/* first the tasksInCurrentProject array should be initialise, we only what the tasks that are in one project
/* initialise assigments array with tasks
* for each task and for each user that task was assigne to, create assigment
*/
function initAssigments() {
    tasksInCurrentProject.forEach(task => {
        task["assigned-to"].forEach(userId => {
            assigments.push(createAssigment(users[userId], task)); //here userId is a index to users array of objects 
        });
    });
}

/**
 * 
 * Generates HTML Code for a task
 * 
 * @param {string} categoryClass - CSS class which should label the caterogy
 * @param {string} imgSrc - link tpo the profile picture
 * @param {string} category - Displayed category, e.g "Management"
 * @param {string} description - Description of the task itself
 */
function generateListItem(categoryClass, imgSrc, category, description) {
    return `
    &lt;div class="list-item-content  ${categoryClass}">
    &lt;div class="assigned-to-content">
        &lt;img src="${imgSrc}" class="assigned-to-img rounded-circle">
        &lt;div>Name&lt;br>Contact&lt;/div>
    &lt;/div>
    &lt;div class="category-content">${category}&lt;/div>
    &lt;div class="details-content">${description}&lt;/div>
    &lt;/div>
`;
}

function getProjectMatrix(currentProjetId, currentUserId) {

    let currentUser = getUserById(currentUserId);
    console.log("CURRENT USER", currentUser);
    initUserTasksFromProjectId(currentUser, currentProjetId);
    console.log("Tasks in Project " + currentProjetId, tasksInCurrentProject);
    initAssigments();
    console.log("Assigments of user " + currentUserId, assigments);

    //html element that contains all the listItems
    let listContent = document.getElementById("list");
    let listItems = [];

    assigments.forEach(assigment => {
        let htmlCode = `
        &lt;div class="category">

        &lt;/div>
        `;

        let listItemContent = document.createElement("div");
        listItemContent.classList.add("list-item-content");

        //user img 
        let assignedToImg = document.createElement("img");
        assignedToImg.src = assigment.to.img;
        assignedToImg.classList.add("assigned-to-img", "rounded-circle");
        //listItemContent.appendChild(assignedToImg);

        //user name and contact for whom the tasks was assigned
        let userNameAndContact = document.createElement("div");
        userNameAndContact.innerHTML = assigment.to.name + "&lt;br>" + assigment.to.eMail;
        //listItemContent.appendChild(userNameAndContact);

        let assignedToContent = document.createElement("div");
        assignedToContent.classList.add("assigned-to-content");
        assignedToContent.appendChild(assignedToImg);
        assignedToContent.appendChild(userNameAndContact);
        listItemContent.appendChild(assignedToContent);

        //task category value
        let categoryContent = document.createElement("div");
        categoryContent.classList.add("category-content");
        categoryContent.innerHTML = assigment.category;
        listItemContent.appendChild(categoryContent);

        //task description value
        let descrition = document.createElement("div");
        descrition.classList.add("details-content");
        descrition.innerHTML = assigment.details;
        listItemContent.appendChild(descrition);

        //TODO
        //get importance and due-date values
        //calculate the level of task importance and urgency
        //apply correct color to task
        listItemContent.classList.add(assigment.eisenhowerMatrixCategorie)

        listItems.push(listItemContent);
    });




    /* console.log("TASKS LIST IN CURRENT PROJECT "+currentProjetId, tasksInCurrentProject);*/
    //display list of assigned tasks in order of level of urgency and importance

    /*let totalUsers = tasks["user-tasks"];
    console.log('Size of Total Users', totalUsers);
    let totalTasks = 0;
    for (let i = 0; i &lt; totalUsers.length; i++) {
        totalTasks += totalUsers[i]["tasks"].length;
    }
    console.log('total tasks ', totalTasks);

    //get current user tasks list of current project

    let currentUserTaskslist = [];
    for (let i = 0; i &lt; totalUsers.length; i++) {//get all tasks assigned by the user
        if (totalUsers[i]["user-id"] == currentUserId) {
            //found current user
            //collect all tasks assigned by the current user
            currentUserTaskslist = totalUsers[i]["tasks"];
            break;
        }
    }

    //search tasks list, if task assigned in current project, push it
    let currentProjectAssignedTasks = [];
    for (let i = 0; i &lt; currentUserTaskslist.length; i++) {
        for (let j = 0; j &lt; currentUserTaskslist[i]["in-projects"].length; j++) {
            if (currentUserTaskslist[i]["in-projects"][j] == currentProjetId) {
                currentProjectAssignedTasks.push(currentUserTaskslist[i]);
            }
        }
    }

    console.log("Current project " + currentProjetId + " of current user " + currentUserId + " has " + currentProjectAssignedTasks.length + " tasks assigned");

    //create same number of list-item-content elements as the number of tasks to append to list-content element 

    let listItems = [];
    for (let i = 0; i &lt; currentProjectAssignedTasks.length; i++) {

        let listItemContent = document.createElement("div");
        listItemContent.classList.add("list-item-content");

        //user img 
        let assignedToImg = document.createElement("img");
        assignedToImg.src = "img/person.png";
        assignedToImg.classList.add("assigned-to-img", "rounded-circle");
        //listItemContent.appendChild(assignedToImg);

        //user name and contact for whom the tasks was assigned
        let userNameAndContact = document.createElement("div");
        userNameAndContact.innerHTML = "Name" + "&lt;br>" + "Contact";
        //listItemContent.appendChild(userNameAndContact);

        let assignedToContent = document.createElement("div");
        assignedToContent.classList.add("assigned-to-content");
        assignedToContent.appendChild(assignedToImg);
        assignedToContent.appendChild(userNameAndContact);
        listItemContent.appendChild(assignedToContent);

        //task category value
        let categoryContent = document.createElement("div");
        categoryContent.classList.add("category-content");
        categoryContent.innerHTML = currentProjectAssignedTasks[i]["category"];
        listItemContent.appendChild(categoryContent);

        //task description value
        let descrition = document.createElement("div");
        descrition.classList.add("details-content");
        descrition.innerHTML = currentProjectAssignedTasks[i]["description"];
        listItemContent.appendChild(descrition);

        //TODO
        //get importance and due-date values
        //calculate the level of task importance and urgency
        //apply correct color to task

        listItems.push(listItemContent);
    }*/

    for (let i = 0; i &lt; listItems.length; i++) {
        listContent.appendChild(listItems[i]);
    }

}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#generateListItem">generateListItem</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.5</a> on Wed Aug 12 2020 19:11:16 GMT+0200 (GMT+02:00)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
